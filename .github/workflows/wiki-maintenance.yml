name: Wiki Maintenance

on:
  schedule:
    # Every Monday at 9 AM UTC (weekly)
    - cron: '0 9 * * 1'
  workflow_dispatch:  # Manual trigger

jobs:
  update-wiki:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 50  # Get last 7 days of commits

      - name: Run Wiki Agent
        uses: ./actions/wiki-issue-agent
        with:
          openrouter-api-key: ${{ secrets.OPENROUTER_API_KEY }}
          github-token: ${{ secrets.GITHUB_TOKEN }}
          mode: 'wiki'

      - name: Upload suggestions
        uses: actions/upload-artifact@v4
        with:
          name: wiki-suggestions
          path: wiki-suggestions.md
          retention-days: 30
